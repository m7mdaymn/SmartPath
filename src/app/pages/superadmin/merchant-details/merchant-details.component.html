<div class="settings-page" dir="rtl">
  <!-- Header -->
  <header class="settings-header">
    <div class="header-content">
      <div class="header-main">
        <div class="logo-section">
          <div class="settings-badge">
            <span class="badge-icon">โ๏ธ</span>
            <span class="badge-text">ุฅุนุฏุงุฏุงุช ุงูููุตุฉ</span>
          </div>
          <div class="header-titles">
            <h1 class="main-title">ุฅุฏุงุฑุฉ ูุฅุนุฏุงุฏุงุช ุงููุธุงู</h1>
            <p class="subtitle">ุชููุฆุฉ ููุฑุงูุจุฉ ุฅุนุฏุงุฏุงุช ุงูููุตุฉ</p>
          </div>
        </div>
        
        <div class="header-actions">
          <button class="save-btn" (click)="saveSettings()" [disabled]="isSaving">
            <span *ngIf="!isSaving">๐พ ุญูุธ ุงูุชุบููุฑุงุช</span>
            <span *ngIf="isSaving" class="saving">
              <span class="spinner"></span>
              ุฌุงุฑู ุงูุญูุธ...
            </span>
          </button>
          <button class="refresh-btn" (click)="loadSettings()">
            <span>๐ ุชุญุฏูุซ</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Tabs Navigation -->
  <nav class="settings-tabs">
    <div class="tabs-container">
      <button 
        class="tab-btn" 
        [class.active]="activeTab === 'merchants'"
        (click)="setActiveTab('merchants')"
      >
        <span class="tab-icon">๐ช</span>
        <span class="tab-text">ุฅุฏุงุฑุฉ ุงููุชุงุฌุฑ</span>
        <span class="tab-badge">{{ merchantsData.length }}</span>
      </button>
      
      <button 
        class="tab-btn" 
        [class.active]="activeTab === 'statistics'"
        (click)="setActiveTab('statistics')"
      >
        <span class="tab-icon">๐</span>
        <span class="tab-text">ุงูุฅุญุตุงุฆูุงุช</span>
      </button>
<!--       
      <button 
        class="tab-btn" 
        [class.active]="activeTab === 'platform'"
        (click)="setActiveTab('platform')"
      >
        <span class="tab-icon">๐๏ธ</span>
        <span class="tab-text">ุฅุนุฏุงุฏุงุช ุงูููุตุฉ</span>
      </button> -->
    </div>
  </nav>

  <!-- Main Content -->
  <main class="settings-content">
    <div class="content-container">
      <!-- Merchants Tab -->
      <div *ngIf="activeTab === 'merchants'" class="tab-content merchants-tab">
        <!-- Merchants Header -->
        <div class="merchants-header">
          <div class="merchants-title">
            <h2>ุฅุฏุงุฑุฉ ุงููุชุงุฌุฑ ูุงููุดุชุฑููู</h2>
            <p>ูุฑุงูุจุฉ ูุฅุฏุงุฑุฉ ุฌููุน ูุบุงุณู ุงูุณูุงุฑุงุช ุงููุณุฌูุฉ</p>
          </div>
          
          <div class="merchants-stats">
            <div class="stat-card">
              <div class="stat-icon">๐ช</div>
              <div class="stat-content">
                <div class="stat-value">{{ merchantsData.length }}</div>
                <div class="stat-label">ุฅุฌูุงูู ุงููุชุงุฌุฑ</div>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon">โ</div>
              <div class="stat-content">
                <div class="stat-value">{{ getActiveMerchantsCount() }}</div>
                <div class="stat-label">ูุชุงุฌุฑ ูุดุทุฉ</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Merchants Table -->
        <div class="merchants-table-container">
          <div class="table-header">
            <div class="search-box">
              <input 
                type="text" 
                [(ngModel)]="searchTerm"
                (input)="filterMerchants()"
                placeholder="ุงุจุญุซ ุนู ูุบุณูุฉ..."
                dir="rtl"
              >
              <span class="search-icon">๐</span>
            </div>
            
            <div class="table-actions">
              <button class="export-btn" (click)="exportMerchants()">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M2 8V14H14V8M5.33333 6L8 9.33333L10.6667 6M8 1.33333V9.33333" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                ุชุตุฏูุฑ
              </button>
              <button class="add-btn" (click)="addMerchant()">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M8 2.66667V13.3333M2.66667 8H13.3333" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                ุฅุถุงูุฉ ูุชุฌุฑ
              </button>
            </div>
          </div>

          <div class="table-wrapper">
            <table class="merchants-table">
              <thead>
                <tr>
                  <th>ุงุณู ุงููุบุณูุฉ</th>
                  <th>ุงููุงูู</th>
                  <th>ุงููุฏููุฉ</th>
                  <th>ุงูุจุงูุฉ</th>
                  <th>ุงูุนููุงุก</th>
                  <th>ุงูุบุณูุงุช</th>
                  <th>ุชุงุฑูุฎ ุงูุงูุถูุงู</th>
                  <th>ุงูุญุงูุฉ</th>
                  <th>ุงูุฅุฌุฑุงุกุงุช</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let merchant of filteredMerchants" class="table-row">
                  <td>
                    <div class="merchant-info">
                      <span class="merchant-name">{{ merchant.businessName }}</span>
                      <span class="merchant-email">{{ merchant.email }}</span>
                    </div>
                  </td>
                  <td>{{ merchant.ownerName }}</td>
                  <td>
                    <span class="city-badge">{{ merchant.city }}</span>
                  </td>
                  <td>
                    <span class="plan-badge" [class.pro]="merchant.plan === 'pro'">
                      {{ merchant.plan === 'pro' ? 'Pro' : 'Basic' }}
                    </span>
                  </td>
                  <td>
                    <div class="customers-cell">
                      <span class="customers-count">{{ merchant.customers }}</span>
                      <span class="customers-trend" [class.positive]="merchant.customersGrowth > 0">
                        {{ merchant.customersGrowth > 0 ? '+' : '' }}{{ merchant.customersGrowth }}%
                      </span>
                    </div>
                  </td>
                  <td>
                    <span class="washes-count">{{ merchant.totalWashes }}</span>
                  </td>
                  <td>
                    <span class="join-date">{{ formatDate(merchant.joinDate) }}</span>
                  </td>
                  <td>
                    <span 
                      class="status-badge" 
                      [class.active]="merchant.status === 'active'"
                      [class.inactive]="merchant.status === 'inactive'"
                      [class.pending]="merchant.status === 'pending'"
                    >
                      {{ getStatusText(merchant.status) }}
                    </span>
                  </td>
                  <td>
                    <div class="action-buttons">
                      <button 
                        class="action-btn edit-btn"
                        (click)="editMerchant(merchant.id)"
                        title="ุชุนุฏูู"
                      >
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                          <path d="M1 13L3 11M11 1L13 3L5 11L1 13L3 9L11 1Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                      <button 
                        class="action-btn toggle-btn"
                        [class.deactivate]="merchant.status === 'active'"
                        [class.activate]="merchant.status !== 'active'"
                        (click)="toggleMerchantStatus(merchant.id)"
                        title="ุชูุนูู/ุฅููุงู"
                      >
                        {{ merchant.status === 'active' ? 'ุฅููุงู' : 'ุชูุนูู' }}
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            
            <div *ngIf="filteredMerchants.length === 0" class="no-results">
              <span class="no-results-icon">๐ช</span>
              <p>ูุง ุชูุฌุฏ ูุชุงุฆุฌ ูุทุงุจูุฉ</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Statistics Tab -->
      <div *ngIf="activeTab === 'statistics'" class="tab-content statistics-tab">
        <div class="statistics-header">
          <h2>ุฅุญุตุงุฆูุงุช ุงูููุตุฉ</h2>
          <p>ุชุญููู ุดุงูู ูุฃุฏุงุก ุงูููุตุฉ ูุฅุญุตุงุฆูุงุชูุง</p>
        </div>

        <!-- Overview Stats -->
        <div class="overview-stats">
          <div class="overview-card">
            <div class="overview-icon">๐ข</div>
            <div class="overview-content">
              <h3>ุฅุฌูุงูู ุงููุบุงุณู</h3>
              <div class="overview-value">{{ statistics.totalBusinesses }}</div>
              <div class="overview-detail">
                <span class="active-count">{{ statistics.activeBusinesses }} ูุดุท</span>
                <span class="inactive-count">{{ statistics.inactiveBusinesses }} ุบูุฑ ูุดุท</span>
              </div>
            </div>
          </div>
          
          <div class="overview-card">
            <div class="overview-icon">๐ฅ</div>
            <div class="overview-content">
              <h3>ุฅุฌูุงูู ุงูุนููุงุก</h3>
              <div class="overview-value">{{ statistics.totalCustomers | number }}</div>
              <div class="overview-detail">
                <span class="growth-rate positive">+{{ statistics.customerGrowth }}%</span>
                <span class="growth-label">ููู ูุฐุง ุงูุดูุฑ</span>
              </div>
            </div>
          </div>
          
          <div class="overview-card">
            <div class="overview-icon">๐</div>
            <div class="overview-content">
              <h3>ุฅุฌูุงูู ุงูุบุณูุงุช</h3>
              <div class="overview-value">{{ statistics.totalWashes | number }}</div>
              <div class="overview-detail">
                <span class="period-count">{{ statistics.last30DaysWashes }} ุขุฎุฑ 30 ููู</span>
                <span class="avg-washes">{{ statistics.avgWashesPerDay }} / ููู</span>
              </div>
            </div>
          </div>
          
          <div class="overview-card">
            <div class="overview-icon">๐</div>
            <div class="overview-content">
              <h3>ุฅุฌูุงูู ุงูููุงูุขุช</h3>
              <div class="overview-value">{{ statistics.totalRewards }}</div>
              <div class="overview-detail">
                <span class="redeemed-count">{{ statistics.redeemedRewards }} ุชู ุงุณุชุจุฏุงููุง</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Plan Distribution -->
        <div class="plan-distribution">
          <h3>ุชูุฒูุน ุงูุจุงูุงุช</h3>
          <div class="distribution-grid">
            <div class="plan-card basic-plan">
              <div class="plan-header">
                <h4>ุจุงูุฉ Basic</h4>
                <span class="plan-count">{{ statistics.basicPlanCount }}</span>
              </div>
              <div class="plan-progress">
                <div class="progress-bar">
                  <div 
                    class="progress-fill" 
                    [style.width.%]="(statistics.basicPlanCount / statistics.totalBusinesses) * 100"
                  ></div>
                </div>
                <span class="progress-percent">
                  {{ ((statistics.basicPlanCount / statistics.totalBusinesses) * 100).toFixed(1) }}%
                </span>
              </div>
              <div class="plan-details">
                <div class="detail-item">
                  <span class="detail-label">ูุชูุณุท ุงูุนููุงุก:</span>
                  <span class="detail-value">{{ statistics.basicAvgCustomers }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">ูุชูุณุท ุงูุบุณูุงุช:</span>
                  <span class="detail-value">{{ statistics.basicAvgWashes }}</span>
                </div>
              </div>
            </div>
            
            <div class="plan-card pro-plan">
              <div class="plan-header">
                <h4>ุจุงูุฉ Pro</h4>
                <span class="plan-count">{{ statistics.proPlanCount }}</span>
              </div>
              <div class="plan-progress">
                <div class="progress-bar">
                  <div 
                    class="progress-fill" 
                    [style.width.%]="(statistics.proPlanCount / statistics.totalBusinesses) * 100"
                  ></div>
                </div>
                <span class="progress-percent">
                  {{ ((statistics.proPlanCount / statistics.totalBusinesses) * 100).toFixed(1) }}%
                </span>
              </div>
              <div class="plan-details">
                <div class="detail-item">
                  <span class="detail-label">ูุชูุณุท ุงูุนููุงุก:</span>
                  <span class="detail-value">{{ statistics.proAvgCustomers }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">ูุชูุณุท ุงูุบุณูุงุช:</span>
                  <span class="detail-value">{{ statistics.proAvgWashes }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Activity Summary -->
        <div class="activity-summary">
          <h3>ููุฎุต ุงููุดุงุท</h3>
          <div class="activity-grid">
            <div class="activity-card">
              <div class="activity-icon">๐</div>
              <div class="activity-content">
                <h4>ุงูุบุณูุงุช ุงูุดูุฑูุฉ</h4>
                <div class="activity-value">{{ statistics.last30DaysWashes }}</div>
                <div class="activity-trend positive">+12.5% ุนู ุงูุดูุฑ ุงููุงุถู</div>
              </div>
            </div>
            
            <div class="activity-card">
              <div class="activity-icon">๐ผ</div>
              <div class="activity-content">
                <h4>ุงููุบุงุณู ุงููุดุทุฉ</h4>
                <div class="activity-value">{{ statistics.activeBusinesses }}</div>
                <div class="activity-trend positive">+{{ statistics.activeBusinessesGrowth }}%</div>
              </div>
            </div>
            
            <div class="activity-card">
              <div class="activity-icon">โก</div>
              <div class="activity-content">
                <h4>ูุชูุณุท ุงูุบุณูุงุช</h4>
                <div class="activity-value">{{ statistics.avgWashesPerBusiness }}</div>
                <div class="activity-trend positive">+{{ statistics.avgWashesGrowth }}%</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Platform Settings Tab -->
      <div *ngIf="activeTab === 'platform'" class="tab-content platform-tab">
        <div class="platform-header">
          <h2>ุฅุนุฏุงุฏุงุช ุงูููุตุฉ</h2>
          <p>ุชููุฆุฉ ุฅุนุฏุงุฏุงุช ุงููุธุงู ูุงูููุตุฉ</p>
        </div>

        <!-- General Settings -->
        <div class="settings-section">
          <h3 class="section-title">ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ</h3>
          
          <div class="settings-grid">
            <!-- Platform Name -->
            <div class="setting-item">
              <label class="setting-label">
                ุงุณู ุงูููุตุฉ
                <span class="required">*</span>
              </label>
              <input 
                type="text" 
                [(ngModel)]="platformSettings.name"
                class="setting-input"
                placeholder="Digital Pass"
              >
              <span class="setting-hint">ุงูุงุณู ุงูุฐู ูุธูุฑ ูููุณุชุฎุฏููู</span>
            </div>
            
            <!-- Support Email -->
            <div class="setting-item">
              <label class="setting-label">
                ุจุฑูุฏ ุงูุฏุนู
                <span class="required">*</span>
              </label>
              <input 
                type="email" 
                [(ngModel)]="platformSettings.supportEmail"
                class="setting-input"
                placeholder="support@digitalpass.com"
              >
              <span class="setting-hint">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุฏุนู ุงูููู</span>
            </div>
            
            <!-- Support Phone -->
            <div class="setting-item">
              <label class="setting-label">
                ูุงุชู ุงูุฏุนู
              </label>
              <input 
                type="tel" 
                [(ngModel)]="platformSettings.supportPhone"
                class="setting-input"
                placeholder="0548290509"
              >
              <span class="setting-hint">ุฑูู ุงููุงุชู ููุฏุนู</span>
            </div>
          </div>
        </div>

        <!-- Subscription Settings -->
        <div class="settings-section">
          <h3 class="section-title">ุฅุนุฏุงุฏุงุช ุงูุงุดุชุฑุงูุงุช</h3>
          
          <div class="settings-grid">
            <!-- Basic Plan Price -->
            <div class="setting-item">
              <label class="setting-label">
                ุณุนุฑ ุจุงูุฉ Basic
                <span class="required">*</span>
              </label>
              <div class="price-input">
                <input 
                  type="number" 
                  [(ngModel)]="platformSettings.basicPlanPrice"
                  class="setting-input"
                  min="0"
                >
                <span class="price-suffix">ุฑูุงู / ุดูุฑู</span>
              </div>
              <span class="setting-hint">ุงูุณุนุฑ ุงูุดูุฑู ููุจุงูุฉ ุงูุฃุณุงุณูุฉ</span>
            </div>
            
            <!-- Pro Plan Price -->
            <div class="setting-item">
              <label class="setting-label">
                ุณุนุฑ ุจุงูุฉ Pro
                <span class="required">*</span>
              </label>
              <div class="price-input">
                <input 
                  type="number" 
                  [(ngModel)]="platformSettings.proPlanPrice"
                  class="setting-input"
                  min="0"
                >
                <span class="price-suffix">ุฑูุงู / ุดูุฑู</span>
              </div>
              <span class="setting-hint">ุงูุณุนุฑ ุงูุดูุฑู ููุจุงูุฉ ุงููุชูุฏูุฉ</span>
            </div>
            
            <!-- Trial Period -->
            <div class="setting-item">
              <label class="setting-label">
                ูุชุฑุฉ ุงูุชุฌุฑุจุฉ
              </label>
              <div class="trial-input">
                <input 
                  type="number" 
                  [(ngModel)]="platformSettings.trialPeriod"
                  class="setting-input"
                  min="0"
                  max="30"
                >
                <span class="trial-suffix">ููู</span>
              </div>
              <span class="setting-hint">ุนุฏุฏ ุฃูุงู ุงูุชุฌุฑุจุฉ ุงููุฌุงููุฉ (0 ูุฅูุบุงุก ุงูุชุฌุฑุจุฉ)</span>
            </div>
          </div>
        </div>

        <!-- Notification Settings -->
        <div class="settings-section">
          <h3 class="section-title">ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช</h3>
          
          <div class="settings-list">
            <!-- Email Notifications -->
            <div class="setting-toggle">
              <div class="toggle-content">
                <div class="toggle-icon">๐ง</div>
                <div class="toggle-text">
                  <h4>ุงูุฅุดุนุงุฑุงุช ุงูุจุฑูุฏูุฉ</h4>
                  <p>ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</p>
                </div>
              </div>
              <label class="toggle-switch">
                <input 
                  type="checkbox" 
                  [(ngModel)]="platformSettings.emailNotifications"
                  class="toggle-input"
                >
                <span class="toggle-slider"></span>
              </label>
            </div>
            
            <!-- SMS Notifications -->
            <div class="setting-toggle">
              <div class="toggle-content">
                <div class="toggle-icon">๐ฑ</div>
                <div class="toggle-text">
                  <h4>ุฅุดุนุงุฑุงุช SMS</h4>
                  <p>ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุนุจุฑ ุงูุฑุณุงุฆู ุงููุตูุฉ</p>
                </div>
              </div>
              <label class="toggle-switch">
                <input 
                  type="checkbox" 
                  [(ngModel)]="platformSettings.smsNotifications"
                  class="toggle-input"
                >
                <span class="toggle-slider"></span>
              </label>
            </div>
            
            <!-- Renewal Reminders -->
            <div class="setting-toggle">
              <div class="toggle-content">
                <div class="toggle-icon">โฐ</div>
                <div class="toggle-text">
                  <h4>ุชุฐููุฑ ุงูุชุฌุฏูุฏ</h4>
                  <p>ุชุฐููุฑ ุงููุดุชุฑููู ุจุชุฌุฏูุฏ ุงูุงุดุชุฑุงู</p>
                </div>
              </div>
              <label class="toggle-switch">
                <input 
                  type="checkbox" 
                  [(ngModel)]="platformSettings.renewalReminders"
                  class="toggle-input"
                >
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <!-- Maintenance Mode -->
        <div class="settings-section">
          <h3 class="section-title">ูุถุน ุงูุตูุงูุฉ</h3>
          
          <div class="maintenance-settings">
            <div class="maintenance-toggle">
              <div class="toggle-content">
                <div class="toggle-icon">๐ง</div>
                <div class="toggle-text">
                  <h4>ุชูุนูู ูุถุน ุงูุตูุงูุฉ</h4>
                  <p>ุฅููุงู ุงููุธุงู ูุคูุชุงู ููุตูุงูุฉ ูุงูุชุญุฏูุซุงุช</p>
                </div>
              </div>
              <label class="toggle-switch">
                <input 
                  type="checkbox" 
                  [(ngModel)]="platformSettings.maintenanceMode"
                  class="toggle-input"
                  (change)="onMaintenanceToggle()"
                >
                <span class="toggle-slider"></span>
              </label>
            </div>
            
            <div *ngIf="platformSettings.maintenanceMode" class="maintenance-message">
              <label class="setting-label">
                ุฑุณุงูุฉ ุงูุตูุงูุฉ
              </label>
              <textarea 
                [(ngModel)]="platformSettings.maintenanceMessage"
                class="setting-textarea"
                placeholder="ูุธุงู ุงูุตูุงูุฉ ููุฏ ุงูุชุทููุฑ ุญุงููุงู..."
                rows="3"
              ></textarea>
              <span class="setting-hint">ุงูุฑุณุงูุฉ ุงูุชู ุชุธูุฑ ูููุณุชุฎุฏููู ุฃุซูุงุก ุงูุตูุงูุฉ</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>