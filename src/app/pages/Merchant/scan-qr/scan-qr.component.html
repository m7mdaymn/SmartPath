<!-- scan-qr.component.html -->
<div class="scan-page" dir="rtl">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1>📷 مسح رمز QR</h1>
      <button class="back-btn" (click)="goBack()">← رجوع</button>
    </div>
  </div>

  <!-- Scan Area -->
  <div class="scan-section">
    <div class="scan-area">
      <div class="scan-frame">
        <div class="scan-overlay">
          <div class="scan-lines"></div>
        </div>
        <div class="scan-placeholder">
          📷
        </div>
      </div>
      
      <div class="scan-actions">
        <button class="scan-btn" (click)="openCamera()">
          🔓 فتح الكاميرا
        </button>
        <button class="manual-btn" (click)="openManualInput()">
          ⌨️ إدخال يدوي
        </button>
      </div>
    </div>

    <!-- Quick Instructions -->
    <div class="instructions">
      <h3>كيفية الاستخدام:</h3>
      <ul>
        <li>وجه الكاميرا نحو رمز QR للعميل</li>
        <li>انتظر حتى يتم التعرف تلقائياً</li>
        <li>أو أدخل الرمز يدوياً</li>
      </ul>
    </div>
  </div>

  <!-- Manual Input Modal -->
  <div *ngIf="showManualInput" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h2>إدخال رمز QR يدوياً</h2>
        <button class="close-btn" (click)="closeManualInput()">×</button>
      </div>
      
      <div class="modal-body">
        <div class="input-group">
          <label>رمز QR</label>
          <input type="text" 
                 [(ngModel)]="manualQRCode"
                 placeholder="DP-CUST-XXXX"
                 (keyup.enter)="submitManualQR()">
        </div>
        
        <button class="submit-btn" (click)="submitManualQR()">
          تأكيد
        </button>
      </div>
    </div>
  </div>

  <!-- Scan Result -->
  <div *ngIf="scanResult" class="scan-result" [ngClass]="scanResult.status">
    <div class="result-header">
      <div class="result-icon">
        {{ scanResult.status === 'success' ? '✅' : '❌' }}
      </div>
      <h2>{{ scanResult.title }}</h2>
    </div>
    
    <div class="result-body">
      <div class="customer-info">
        <div class="customer-photo">
          <span *ngIf="!scanResult.customerPhoto">👤</span>
          <img *ngIf="scanResult.customerPhoto" [src]="scanResult.customerPhoto">
        </div>
        <div class="customer-details">
          <h3>{{ scanResult.customerName }}</h3>
          <p>{{ scanResult.customerPhone }}</p>
        </div>
      </div>
      
      <div class="progress-info">
        <div class="progress-label">
          <span>التقدم</span>
          <span>{{ scanResult.currentWashes }} / {{ scanResult.totalWashes }}</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="scanResult.progress"></div>
        </div>
      </div>
      
      <!-- <div class="time-info">
        <span class="time-label">الوقت المتبقي:</span>
        <span class="time-value">{{ scanResult.daysLeft }} يوم</span>
      </div> -->
      
      <div *ngIf="scanResult.rewardEarned" class="reward-alert">
        🎉 مبروك! العميل استحق المكافأة
      </div>
    </div>
    
    <!-- <div class="result-actions">
      <button class="done-btn" (click)="resetScan()">تم</button>
      <button class="new-btn" (click)="scanAgain()">مسح آخر</button>
    </div> -->
  </div>
</div>